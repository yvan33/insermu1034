;function CsSidebar(a){this.id=a.split("%").join("\\%"),this.widgets="",this.name=trim(jQuery("#"+this.id).siblings(".sidebar-name").text()),this.description=trim(jQuery("#"+this.id).find(".sidebar-description").text());var b=jQuery("#cs-widgets-extra").find(".cs-edit-sidebar").clone();jQuery("#"+this.id).parent().append(b),b.find("a").each(function(){addIdToA(jQuery(this),a)})}function trim(a){a=a.replace(/^\s+/,"");for(var b=a.length-1;b>=0;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a}function getIdFromEditbar(a){return a.parent().siblings(".widgets-sortables").attr("id")}function addIdToA(a,b){a.attr("href",a.attr("href")+b)}function getSidebarTitle(a){return a+'<span><img src="images/wpspin_light.gif" class="ajax-feedback" title="" alt=""></span>'}function var_dump(a,b,c,d){var f,g,e="",h="";d||(d=1);for(var i=0;d>i;i++)h+="   ";if("object"!=typeof a)return f=a,"string"==typeof a&&("html"==b&&(f=f.replace(/&/g,"&amp;"),f=f.replace(/>/g,"&gt;"),f=f.replace(/</g,"&lt;")),f=f.replace(/\"/g,'"'),f='"'+f+'"'),"function"==typeof a&&b&&(f=new String(f).replace(/\n/g,"\n"+h),"html"==b&&(f=f.replace(/&/g,"&amp;"),f=f.replace(/>/g,"&gt;"),f=f.replace(/</g,"&lt;"))),"undefined"==typeof a&&(f="undefined"),"html"==b&&("string"!=typeof f&&(f=new String(f)),f=f.replace(/ /g,"&nbsp;").replace(/\n/g,"<br>")),f;for(var j in a){if(c&&d>c)f="*RECURSION*";else try{f=var_dump(a[j],b,c,d+1)}catch(k){continue}g=var_dump(j,b,c,d+1),e+=g+":"+f+",",b&&(e+="\n"+h)}return e=b?"{\n"+h+e.substr(0,e.length-(2+3*d))+"\n"+h.substr(0,h.length-3)+"}":"{"+e.substr(0,e.length-1)+"}","html"==b&&(e=e.replace(/ /g,"&nbsp;").replace(/\n/g,"<br>")),e}!function(a){function b(b,c){function r(){return d.update(),t(),d}function s(){var a=m.toLowerCase();j.obj.css(l,n/h.ratio),g.obj.css(l,-n),p.start=j.obj.offset()[l],h.obj.css(a,i[c.axis]),i.obj.css(a,i[c.axis]),j.obj.css(a,j[c.axis])}function t(){q?f.obj[0].ontouchstart=function(a){1===a.touches.length&&(u(a.touches[0]),a.stopPropagation())}:(j.obj.bind("mousedown",u),i.obj.bind("mouseup",w)),c.scroll&&window.addEventListener?(e[0].addEventListener("DOMMouseScroll",v,!1),e[0].addEventListener("mousewheel",v,!1)):c.scroll&&(e[0].onmousewheel=v)}function u(b){var c=parseInt(j.obj.css(l),10);p.start=k?b.pageX:b.pageY,o.start="auto"==c?0:c,q?(document.ontouchmove=function(a){a.preventDefault(),w(a.touches[0])},document.ontouchend=x):(a(document).bind("mousemove",w),a(document).bind("mouseup",x),j.obj.bind("mouseup",x))}function v(b){if(g.ratio<1){var d=b||window.event,e=d.wheelDelta?d.wheelDelta/120:-d.detail/3;n-=e*c.wheel,n=Math.min(g[c.axis]-f[c.axis],Math.max(0,n)),j.obj.css(l,n/h.ratio),g.obj.css(l,-n),(c.lockscroll||n!==g[c.axis]-f[c.axis]&&0!==n)&&(d=a.event.fix(d),d.preventDefault())}}function w(a){g.ratio<1&&(o.now=q?Math.min(i[c.axis]-j[c.axis],Math.max(0,o.start+(p.start-(k?a.pageX:a.pageY)))):Math.min(i[c.axis]-j[c.axis],Math.max(0,o.start+((k?a.pageX:a.pageY)-p.start))),n=o.now*h.ratio,g.obj.css(l,-n),j.obj.css(l,o.now))}function x(){a(document).unbind("mousemove",w),a(document).unbind("mouseup",x),j.obj.unbind("mouseup",x),document.ontouchmove=document.ontouchend=null}var d=this,e=b,f={obj:a(".viewport",b)},g={obj:a(".overview",b)},h={obj:a(".scrollbar",b)},i={obj:a(".track",h.obj)},j={obj:a(".thumb",h.obj)},k="x"===c.axis,l=k?"left":"top",m=k?"Width":"Height",n=0,o={start:0,now:0},p={},q="ontouchstart"in document.documentElement?!0:!1;return this.update=function(a){f[c.axis]=f.obj[0]["offset"+m],g[c.axis]=g.obj[0]["scroll"+m],g.ratio=f[c.axis]/g[c.axis],h.obj.toggleClass("disable",g.ratio>=1),i[c.axis]="auto"===c.size?f[c.axis]:c.size,j[c.axis]=Math.min(i[c.axis],Math.max(0,"auto"===c.sizethumb?i[c.axis]*g.ratio:c.sizethumb)),h.ratio="auto"===c.sizethumb?g[c.axis]/i[c.axis]:(g[c.axis]-f[c.axis])/(i[c.axis]-j[c.axis]),n="relative"===a&&g.ratio<=1?Math.min(g[c.axis]-f[c.axis],Math.max(0,n)):0,n="bottom"===a&&g.ratio<=1?g[c.axis]-f[c.axis]:isNaN(parseInt(a,10))?n:parseInt(a,10),s()},r()}a.tiny=a.tiny||{},a.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto"}},a.fn.tinyscrollbar=function(c){var d=a.extend({},a.tiny.scrollbar.options,c);return this.each(function(){a(this).data("tsb",new b(a(this),d))}),this},a.fn.tinyscrollbar_update=function(b){return a(this).data("tsb").update(b)}}(jQuery),CsSidebar.prototype.initDrag=function(a){var b,c;a("#widget-list").children(".widget").draggable("destroy").draggable({connectToSortable:"div.widgets-sortables",handle:"> .widget-top > .widget-title",distance:2,helper:"clone",zIndex:5,containment:"document",start:function(a,b){b.helper.find("div.widget-description").hide(),c=this.id},stop:function(){b&&a(b).hide(),b=""}}),a("#"+this.id).sortable({placeholder:"widget-placeholder",items:"> .widget",handle:"> .widget-top > .widget-title",cursor:"move",distance:2,containment:"document",start:function(a,b){b.item.children(".widget-inside").hide(),b.item.css({margin:"",width:""})},stop:function(d,e){if(e.item.hasClass("ui-draggable")&&e.item.data("draggable")&&e.item.draggable("destroy"),e.item.hasClass("deleting"))return wpWidgets.save(e.item,1,0,1),e.item.remove(),void 0;var f=e.item.find("input.add_new").val(),g=e.item.find("input.multi_number").val(),h=c,i=a(this).attr("id");return e.item.css({margin:"",width:""}),c="",f?("multi"==f?(e.item.html(e.item.html().replace(/<[^<>]+>/g,function(a){return a.replace(/__i__|%i%/g,g)})),e.item.attr("id",h.replace("__i__",g)),g++,a("div#"+h).find("input.multi_number").val(g)):"single"==f&&(e.item.attr("id","new-"+h),b="div#"+h),wpWidgets.save(e.item,0,0,1),e.item.find("input.add_new").val(""),e.item.find("a.widget-action").click(),void 0):(wpWidgets.saveOrder(i),void 0)},receive:function(b,c){if(""==c.sender[0].id)return csSidebars.showMessage(a("#oldbrowsererror").text(),!0),!1;var d=a(c.sender);a(this).is(":visible")&&-1==this.id.indexOf("orphaned_widgets")||d.sortable("cancel"),-1==d.attr("id").indexOf("orphaned_widgets")||d.children(".widget").length||d.parents(".orphan-sidebar").slideUp(400,function(){a(this).remove()})}}),a("div.widgets-sortables").sortable("option","connectWith","div.widgets-sortables").parent().filter(".closed").children(".widgets-sortables").sortable("disable"),a("#available-widgets").droppable("destroy").droppable({tolerance:"pointer",accept:function(b){return"widget-list"!=a(b).parent().attr("id")},drop:function(b,c){c.draggable.addClass("deleting"),a("#removing-widget").hide().children("span").html("")},over:function(b,c){c.draggable.addClass("deleting"),a("div.widget-placeholder").hide(),c.draggable.hasClass("ui-sortable-helper")&&a("#removing-widget").show().children("span").html(c.draggable.find("div.widget-title").children("h4").html())},out:function(b,c){c.draggable.removeClass("deleting"),a("div.widget-placeholder").show(),a("#removing-widget").hide().children("span").html("")}})},CsSidebar.prototype.remove=function(a){var b=this.id.split("\\").join(""),c=this.id,d={action:"cs-ajax",cs_action:"cs-delete-sidebar","delete":b,nonce:a("#_delete_nonce").val()};a.post(ajaxurl,d,function(b){b.success&&a("#"+c).parent().slideUp("fast",function(){a(this).remove()}),a("#_delete_nonce").val(b.nonce),csSidebars.showMessage(b.message,!b.success)})},CsSidebar.prototype.showEdit=function(a){var b=this.id.split("\\").join("");return editbar=a("#"+this.id).siblings(".cs-edit-sidebar"),this.editbar=editbar.html(),editbar.html(a("#cs-widgets-extra").find(".cs-cancel-edit-bar").html()),addIdToA(editbar.find(".cs-advanced-edit"),b),this.widgets=a("#"+this.id).detach(),editbar.before('<div id="'+b+'" class="widgets-sortables"></div>'),form=a("#cs-widgets-extra").find(".sidebar-form").clone(),form.find("form").addClass("cs-edit-form"),form.find(".sidebar_name").val(this.name).attr("id","edit_sidebar_name"),form.find(".sidebar_description").val(this.description).attr("id","edit_sidebar_description"),thiscs=this,form.find(".cs-create-sidebar").removeClass("cs-create-sidebar").addClass("cs-edit-sidebar").val(a("#cs-save").text()).attr("id","edit_sidebar_submit").on("click",function(){return thiscs.edit(a),!1}),editbar.siblings("#"+this.id).prepend(form),!1},CsSidebar.prototype.cancelEdit=function(a){editbar=a("#"+this.id).siblings(".cs-edit-sidebar"),editbar.html(this.editbar),editbar.siblings("#"+this.id).remove(),editbar.before(this.widgets)},CsSidebar.prototype.edit=function(a){var b="#"+this.id,c=this.id.split("\\").join(""),e=(this.id,{action:"cs-ajax",cs_action:"cs-edit-sidebar",sidebar_name:a("#"+this.id).find("#edit_sidebar_name").val(),sidebar_description:a("#"+this.id).find("#edit_sidebar_description").val(),cs_id:c,nonce:a("#_edit_nonce").val()});a.post(ajaxurl,e,function(d){d.success&&(sidebar=csSidebars.find(c),editbar=a(b).siblings(".cs-edit-sidebar"),a(b).remove(),editbar.before(sidebar.widgets),editbar.html(sidebar.editbar),a(b).find(".description").text(d.description),a(b).siblings(".sidebar-name").find("h3").html(getSidebarTitle(d.name))),a("#_edit_nonce").val(d.nonce),csSidebars.showMessage(d.message,!d.success)})},CsSidebar.prototype.showWhere=function(){},CsSidebar.prototype.where=function(){};var csSidebars,msgTimer;!function(a){csSidebars={sidebars:[],init:function(){csSidebars.scrollSetUp().addCSControls().showCreateSidebar().createCsSidebars().setEditbarsUp()},scrollSetUp:function(){return a("#widgets-right").addClass("overview").wrap('<div class="viewport" />'),a(".viewport").height(a(window).height()-60),a(".widget-liquid-right").height(a(window).height()).prepend('<div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>').tinyscrollbar(),a(window).resize(function(){a(".widget-liquid-right").height(a(window).height()),a(".viewport").height(a(window).height()-60),a(".widget-liquid-right").tinyscrollbar_update("relative")}),a("#widgets-right").resize(function(){a(".widget-liquid-right").tinyscrollbar_update("relative")}),a(".widget-liquid-right").click(function(){setTimeout("csSidebars.updateScroll()",400)}),a(".widget-liquid-right").hover(function(){a(".scrollbar").fadeIn()},function(){a(".scrollbar").fadeOut()}),csSidebars},addCSControls:function(){return a("#cs-title-options").detach().prependTo("#widgets-right").show(),csSidebars},showCreateSidebar:function(){return a(".create-sidebar-button").click(function(){if(0==a("#new-sidebar-holder").length){var b=a("#cs-new-sidebar").clone(!0,!0).attr("id","new-sidebar-holder").hide().insertAfter("#cs-title-options");b.find("._widgets-sortables").addClass("widgets-sortables").removeClass("_widgets-sortables").attr("id","new-sidebar"),b.find(".sidebar-form").attr("id","new-sidebar-form"),b.find(".sidebar_name").attr("id","sidebar_name"),b.find(".sidebar_description").attr("id","sidebar_description"),b.find(".cs-create-sidebar").attr("id","cs-create-sidebar"),b.slideDown();var c=b.children(".sidebar-name");c.click(function(){var b=a(this).siblings(".widgets-sortables"),c=a(this).parent();c.hasClass("closed")?(c.removeClass("closed"),b.sortable("enable").sortable("refresh")):(b.sortable("disable"),c.addClass("closed"))}),csSidebars.setCreateSidebar()}else a("#cs-options").find(".ajax-feedback").css("visibility","hidden");return!1}),csSidebars},setCreateSidebar:function(){return a("#cs-create-sidebar").click(function(){var b={action:"cs-ajax",cs_action:"cs-create-sidebar",nonce:a("#_create_nonce").val(),sidebar_name:a("#sidebar_name").val(),sidebar_description:a("#sidebar_description").val()};return a("#new-sidebar-form").find(".ajax-feedback").css("visibility","visible"),a.post(ajaxurl,b,function(b){if(b.success){var e,c=a("#new-sidebar-holder"),d=a("#widgets-right").find(".sidebars-column-1");c.removeAttr("id").find(".sidebar-name h3").html(getSidebarTitle(b.name)),c.find("#new-sidebar").attr("id",b.id),d.length&&c.detach().prependTo(d),e=a("#"+b.id).html('<p class="sidebar-description description">'+b.description+"</p>"),csSidebars.add(e.attr("id")).initDrag(a)}a("#_create_nonce").val(b.nonce),csSidebars.showMessage(b.message,!b.success),a("#new-sidebar-form").find(".ajax-feedback").css("visibility","hidden")},"json"),!1}),csSidebars},updateScroll:function(){a(".widget-liquid-right").tinyscrollbar_update("relative")},createCsSidebars:function(){return a("#widgets-right").find(".widgets-sortables").each(function(){"cs-"==a(this).attr("id").substr(0,3)&&csSidebars.add(a(this).attr("id"))}),csSidebars},setEditbarsUp:function(){return a("#widgets-right").on("click","a.delete-sidebar",function(){var b=trim(a(this).parent().siblings(".sidebar-name").text());return confirm(a("#cs-confirm-delete").text()+" "+b)&&csSidebars.find(a(this).parent().siblings(".widgets-sortables").attr("id")).remove(a),!1}),a("#widgets-right").on("click","a.edit-sidebar",function(){return id=getIdFromEditbar(a(this)),csSidebars.find(id).showEdit(a),!1}),a("#widgets-right").on("click","a.where-sidebar",function(){}),a("#widgets-right").on("click","a.cs-cancel-edit",function(){return id=getIdFromEditbar(a(this)),csSidebars.find(id).cancelEdit(a),a(this).parent().html(this.editbar),this.editbar="",!1}),csSidebars},showMessage:function(a,b){var c="cs-update";b&&(c="cs-error");var d=jQuery("#cs-message");if(0!=d.length)clearTimeout(msgTimer),d.removeClass("cs-error cs-update").addClass(c),d.text(a);else{var e='<div id="cs-message" class="cs-message '+c+'">'+a+"</div>";jQuery(e).hide().prependTo("#widgets-left").fadeIn().slideDown()}msgTimer=setTimeout("csSidebars.hideMessage()",7e3)},hideMessage:function(){jQuery("#cs-message").slideUp().remove()},find:function(a){return csSidebars.sidebars[a]},add:function(a){return csSidebars.sidebars[a]=new CsSidebar(a),csSidebars.sidebars[a]}},jQuery(function(a){a("#csfooter").hide(),a("#widgets-right").length>0&&csSidebars.init(),a(".defaultsContainer").hide(),a("#defaultsidebarspage").on("click",".csh3title",function(){a(this).siblings(".defaultsContainer").toggle()}),a("#widgets-right .widgets-sortables").on("sort",function(b,c){a("#widgets-right").top,c.position.top=-a("#widgets-right").css("top")}),a("#widgets-right .widget").on("sortstart",function(){})})}(jQuery);